<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Exclusive Lyrics â€” MpOMLI</title>
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial; text-align:center; padding:28px; color:#111;}
  .wrap{max-width:900px;margin:0 auto;}
  h1{margin-bottom:6px;}
  p.lead{color:#555;}
  .viewer{width:100%;height:70vh;max-height:900px;border:1px solid #ddd;margin-top:18px;box-shadow:0 2px 8px rgba(0,0,0,0.06);}
  /* locked style */
  .locked{filter: blur(8px);pointer-events:none;user-select:none;transition:filter .4s ease;}
  .unlocked{filter:none;pointer-events:auto;user-select:auto;}
  .controls{margin-top:18px;}
  .btn{display:inline-block;padding:12px 18px;border-radius:8px;text-decoration:none;border:1px solid #ccc;background:#f6f6f6;color:#111;margin-right:8px;}
  small.note{display:block;margin-top:12px;color:#666;}
  .reset{font-size:13px;color:#777;border:none;background:transparent;cursor:pointer;text-decoration:underline}
</style>
</head>
<body>
  <div class="wrap">
    <h1>ðŸŽµ Exclusive: MpOMLI (Lyrics)</h1>
    <p class="lead" id="status">Locked &nbsp;â€”&nbsp; Unlock by visiting our Instagram and coming back.</p>

    <!-- PDF viewer (relative path; make sure MpOMLI.pdf is in the same repo root) -->
    <iframe id="pdfViewer" class="viewer locked" src="MpOMLI.pdf" width="100%" height="800" frameborder="0"></iframe>

    <div class="controls">
      <!-- Visit Instagram - this onclick sets the unlock flag then opens Instagram -->
      <a id="visitBtn" class="btn" href="https://instagram.com/indiegene._" target="_blank" rel="noopener" onclick="markVisited()">Visit our Instagram</a>

      <!-- Small reset for testing (hidden once unlocked) -->
      <button id="resetBtn" class="reset" style="display:none" onclick="resetUnlock()">Reset unlock</button>

      <small class="note">Tip: after tapping Instagram, come back to this tab (use Back or switch app) to see the lyrics unlock.</small>
    </div>
  </div>

<script>
const STORAGE_KEY = "mpomli_visited_v1";

// Called when user clicks Visit Instagram (before navigation)
function markVisited(){
  try{
    localStorage.setItem(STORAGE_KEY, Date.now().toString());
  }catch(e){}
  // Note: navigation to Instagram is done by the anchor's href/target.
}

// Unlock function: removes blur and updates UI
function unlock(){
  const viewer = document.getElementById("pdfViewer");
  if(!viewer) return;
  viewer.classList.remove("locked");
  viewer.classList.add("unlocked");
  document.getElementById("status").innerText = "âœ… Lyrics unlocked â€” enjoy!";
  // hide Visit button, show Reset
  document.getElementById("visitBtn").style.display = "none";
  document.getElementById("resetBtn").style.display = "inline-block";
}

// Check whether the visited flag exists
function checkUnlock(){
  try{
    const v = localStorage.getItem(STORAGE_KEY);
    if(v) { unlock(); return true; }
  }catch(e){}
  return false;
}

// Reset (for testing) -- clears flag and reloads
function resetUnlock(){
  try{ localStorage.removeItem(STORAGE_KEY); }catch(e){}
  location.reload();
}

// On load, check unlock status
window.addEventListener('load', function(){ checkUnlock(); });

// If user returns to tab (visibilitychange/focus), check again
document.addEventListener('visibilitychange', function(){ if(!document.hidden) checkUnlock(); });
window.addEventListener('focus', function(){ checkUnlock(); });

</script>
</body>
</html>
